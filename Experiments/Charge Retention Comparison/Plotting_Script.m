%% High voltage versus displacement comparison between TPU, 18um BOPP, and 15um BOPP
clc; clear all; close all;
t = 10:0.01:(9999/100);
%% Comparison at 5kV ramp amplitude
TPU_5KV = csvread('TPU_5kv_0pt5hz_ramp_pos_polarity_136g_load.csv',1000,2,[1000,2,9999,2]);
BOPP15um_5KV = csvread('15umBOPP_5kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);
BOPP18um_5KV = csvread('18umBOPP_5kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]); % Redo needed!

% Find local maxima
[pks1,locs1] = findpeaks(TPU_5KV, 100, 'MinPeakDistance',1.8);
[pks2,locs2] = findpeaks(BOPP15um_5KV, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP18um_5KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF1 = islocalmin(TPU_5KV,'MinSeparation',1.6,'SamplePoints',t);
TF2 = islocalmin(BOPP15um_5KV,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP18um_5KV,'MinSeparation',1.6,'SamplePoints',t);

figure(1)
plot((locs1+10)/2,pks1,'r+', 'MarkerSize',5); hold on
plot((locs2+10)/2,pks2,'go', 'MarkerSize',5); 
plot((locs3+10)/2,pks3,'b*', 'MarkerSize',5); 

plot(t(TF1)/2,TPU_5KV(TF1),'r+', 'MarkerSize',5)
plot(t(TF2)/2,BOPP15um_5KV(TF2),'go', 'MarkerSize',5)
plot(t(TF3)/2,BOPP18um_5KV(TF3),'b*', 'MarkerSize',5)
ylim([-0.2 1.4]);
hTitle  = title ('Displacement over 50 Cycles of 3 actuators at 5kV');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '35\mum TPU'                      , ...
            '15\mum BOPP'                     , ...
            '18\mum BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 5kV_3act.svg 

%% Comparison at 6kV ramp amplitude
TPU_6KV = csvread('TPU_6kv_0pt5hz_ramp_pos_polarity_136g_load.csv',1000,2,[1000,2,9999,2])-50.253;
BOPP15um_6KV = csvread('15umBOPP_6kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);
BOPP18um_6KV = csvread('18umBOPP_6kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2])+0.01;

% Find local maxima
[pks1,locs1] = findpeaks(TPU_6KV, 100, 'MinPeakDistance',1.8);
[pks2,locs2] = findpeaks(BOPP15um_6KV, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP18um_6KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF1 = islocalmin(TPU_6KV,'MinSeparation',1.6,'SamplePoints',t);
TF2 = islocalmin(BOPP15um_6KV,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP18um_6KV,'MinSeparation',1.6,'SamplePoints',t);

figure(2)
plot((locs1+10)/2,pks1,'r+','MarkerSize',5); hold on
plot((locs2+10)/2,pks2,'go','MarkerSize',5); 
plot((locs3+10)/2,pks3,'b*','MarkerSize',5); 

plot(t(TF1)/2,TPU_6KV(TF1),'r+','MarkerSize',5)
plot(t(TF2)/2,BOPP15um_6KV(TF2),'go','MarkerSize',5)
plot(t(TF3)/2,BOPP18um_6KV(TF3),'b*','MarkerSize',5)
 
hTitle  = title ('Displacement over 50 Cycles of 3 actuators at 6kV');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '35\mum TPU'                      , ...
            '15\mum BOPP'                     , ...
            '18\mum BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 6kV_3act.svg 
%% Comparison at 7kV ramp amplitude (between TPU, 18um BOPP and 15um BOPP)
TPU_7KV = csvread('TPU_7kv_0pt5hz_ramp_pos_polarity_136g_load_2.csv',1000,2,[1000,2,9999,2]);
BOPP15um_7KV = csvread('15umBOPP_7kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);
BOPP18um_7KV = csvread('18umBOPP_7kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);

% Find local maxima
[pks1,locs1] = findpeaks(TPU_7KV, 100, 'MinPeakDistance',1.8);
[pks2,locs2] = findpeaks(BOPP15um_7KV, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP18um_7KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF1 = islocalmin(TPU_7KV,'MinSeparation',1.6,'SamplePoints',t);
TF2 = islocalmin(BOPP15um_7KV,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP18um_7KV,'MinSeparation',1.6,'SamplePoints',t);

figure(3)
plot((locs1+10)/2,pks1,'r+','MarkerSize',5); hold on
plot((locs2+10)/2,pks2,'go','MarkerSize',5); 
plot((locs3+10)/2,pks3,'b*','MarkerSize',5); 

plot(t(TF1)/2,TPU_7KV(TF1),'r+','MarkerSize',5);
plot(t(TF2)/2,BOPP15um_7KV(TF2),'go','MarkerSize',5);
plot(t(TF3)/2,BOPP18um_7KV(TF3),'b*','MarkerSize',5);

hTitle  = title ('Displacement over 50 Cycles of 3 actuators at 7kV');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
legend('35um TPU','15um BOPP','18um BOPP');
hLegend = legend( ...
            '35um TPU'                      , ...
            '15um BOPP'                     , ...
            '18um BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 7kV_3act.svg 
%% Comparison at 8kV ramp amplitude (between 18um BOPP and 15um BOPP)
BOPP15um_8KV = csvread('15umBOPP_8kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);
BOPP18um_8KV = csvread('18umBOPP_8kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);

% Find local maxima
[pks2,locs2] = findpeaks(BOPP15um_8KV, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP18um_8KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF2 = islocalmin(BOPP15um_8KV,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP18um_8KV,'MinSeparation',1.6,'SamplePoints',t);

figure(4)
plot((locs2+10)/2,pks2,'go','MarkerSize',5); hold on
plot((locs3+10)/2,pks3,'b*','MarkerSize',5); 

plot(t(TF2)/2,BOPP15um_8KV(TF2),'go','MarkerSize',5)
plot(t(TF3)/2,BOPP18um_8KV(TF3),'b*','MarkerSize',5)
 
hTitle  = title ('Displacement over 50 Cycles of 2 actuators at 8kV');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '15\mum BOPP'                     , ...
            '18\mum BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 8kV_2act.svg 

figure(5)
plot(t/2,BOPP15um_8KV,t(TF2)/2,BOPP15um_8KV(TF2),'go','MarkerSize',5);
xlim([20 50]);
ylim([-0.03 0.05]);
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '15\mum BOPP'                     , ...
            '0kV points'                     , ...
            'location', 'NorthWest' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 8kV_15umBOPP_Zoomed.svg 

figure(6)
plot(t/2,BOPP18um_8KV,t(TF3)/2,BOPP18um_8KV(TF3),'bo','MarkerSize',5); hold on;
indx = find(TF3);
for i = 2:length(find(TF3))
    plot(t(indx(i)-30)/2,BOPP18um_8KV(indx(i)-30),'m*','MarkerSize',5); hold on
end
xlim([20 50]);
ylim([-0.03 0.05]);
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '18\mum BOPP'                     , ...
            '2kV points'                     , ...
            '0kV points'                     , ...
            'location', 'NorthWest' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 8kV_18umBOPP_zoomed.svg 

%% Comparison at 5kV ramp amplitude (between 15um BOPP w and w/o no hole sensing electrode)
BOPP15um_5KV_S = csvread('5kV_0pt5hz_15umBOPP_Nohole Sensing_Ramp_POS_pol_136g.csv',1000,2,[1000,2,9999,2])-2.98;
BOPP15um_5KV = csvread('15umBOPP_5kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);

% Find local maxima
[pks2,locs2] = findpeaks(BOPP15um_5KV_S, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP15um_5KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF2 = islocalmin(BOPP15um_5KV_S,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP15um_5KV,'MinSeparation',1.6,'SamplePoints',t);

figure(7)
plot((locs2+10)/2,pks2,'go','MarkerSize',5); hold on
plot((locs3+10)/2,pks3,'b*','MarkerSize',5); 

plot(t(TF2)/2,BOPP15um_5KV_S(TF2),'go','MarkerSize',5)
plot(t(TF3)/2,BOPP15um_5KV(TF3),'b*','MarkerSize',5)
ylim([-0.2 1.4]); 
hTitle  = title ('Displacement over 0.5Hz cycles of BOPP actuators at 5kV amplitude');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '15\mum BOPP w/ sensing electrode'                      , ...
            '15\mum BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 5kV_wvswithout_15umBOPP.svg 

%% Comparison at 6kV ramp amplitude (between 15um BOPP w and w/o no hole sensing electrode)
BOPP15um_6KV_S = csvread('6kV_0pt5hz_15umBOPP_Nohole Sensing_Ramp_POS_pol_136g.csv',1000,2,[1000,2,9999,2]);
BOPP15um_6KV = csvread('15umBOPP_6kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);

% Find local maxima
[pks2,locs2] = findpeaks(BOPP15um_6KV_S, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP15um_6KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF2 = islocalmin(BOPP15um_6KV_S,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP15um_6KV,'MinSeparation',1.6,'SamplePoints',t);

figure(8)
plot((locs2+10)/2,pks2,'go','MarkerSize',5); hold on
plot((locs3+10)/2,pks3,'b*','MarkerSize',5); 

plot(t(TF2)/2,BOPP15um_6KV_S(TF2),'go','MarkerSize',5)
plot(t(TF3)/2,BOPP15um_6KV(TF3),'b*','MarkerSize',5)
ylim([-0.2 1.4]); 
hTitle  = title ('Displacement over 0.5Hz cycles of BOPP actuators at 6kV amplitude');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '15\mum BOPP w/ sensing electrode'                      , ...
            '15\mum BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 6kV_wvswithout_15umBOPP.svg 
%% Comparison at 7kV ramp amplitude (between 15um BOPP w and w/o no hole sensing electrode)
BOPP15um_7KV_S = csvread('7kV_0pt5hz_15umBOPP_Nohole Sensing_Ramp_POS_pol_136g.csv',1000,2,[1000,2,9999,2]);
BOPP15um_7KV = csvread('15umBOPP_7kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);

% Find local maxima
[pks2,locs2] = findpeaks(BOPP15um_7KV_S, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP15um_7KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF2 = islocalmin(BOPP15um_7KV_S,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP15um_7KV,'MinSeparation',1.6,'SamplePoints',t);

figure(9)
plot((locs2+10)/2,pks2,'go','MarkerSize',5); hold on
plot((locs3+10)/2,pks3,'b*','MarkerSize',5); 

plot(t(TF2)/2,BOPP15um_7KV_S(TF2),'go','MarkerSize',5)
plot(t(TF3)/2,BOPP15um_7KV(TF3),'b*','MarkerSize',5)
ylim([-0.2 1.4]); 
hTitle  = title ('Displacement over 0.5Hz cycles of BOPP actuators at 7kV amplitude');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '15\mum BOPP w/ sensing electrode'                      , ...
            '15\mum BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 7kV_wvswithout_15umBOPP.svg 
%% Comparison at 8kV ramp amplitude (between 15um BOPP w and w/o no hole sensing electrode)
BOPP15um_8KV_S = csvread('8kV_0pt5hz_15umBOPP_Nohole Sensing_Ramp_POS_pol_136g.csv',1000,2,[1000,2,9999,2]);
BOPP15um_8KV = csvread('15umBOPP_8kv_0pt5hz_ramp_pos_polarity_136g.csv',1000,2,[1000,2,9999,2]);

% Find local maxima
[pks2,locs2] = findpeaks(BOPP15um_8KV_S, 100, 'MinPeakDistance',1.8);
[pks3,locs3] = findpeaks(BOPP15um_8KV, 100, 'MinPeakDistance',1.8);

% Find local minima
TF2 = islocalmin(BOPP15um_8KV_S,'MinSeparation',1.6,'SamplePoints',t);
TF3 = islocalmin(BOPP15um_8KV,'MinSeparation',1.6,'SamplePoints',t);

figure(10)
plot((locs2+10)/2,pks2,'go','MarkerSize', 5); hold on
plot((locs3+10)/2,pks3,'b*','MarkerSize', 5); 

plot(t(TF2)/2,BOPP15um_8KV_S(TF2),'go','MarkerSize', 5)
plot(t(TF3)/2,BOPP15um_8KV(TF3),'b*','MarkerSize', 5)
 
hTitle  = title ('Displacement over 0.5Hz cycles of BOPP actuators at 8kV amplitude');
hXLabel = xlabel('Cycles'                                           );
hYLabel = ylabel('Displacement (mm)'                                );                 
hLegend = legend( ...
            '15\mum BOPP w/ sensing electrode'                      , ...
            '15\mum BOPP'                     , ...
            'location', 'NorthEast' );
set( gca                       , ...
    'FontName'   , 'Helvetica' );
set([hTitle, hXLabel, hYLabel ], ...
    'FontName'   , 'AvantGarde');
set([hLegend, gca]             , ...
    'FontSize'   , 8           );
set([hXLabel, hYLabel]  , ...
    'FontSize'   , 10          );
set( hTitle                    , ...
    'FontSize'   , 12          , ...
    'FontWeight' , 'bold'      );

set(gca, ...
  'Box'         , 'off'     , ...
  'TickDir'     , 'out'     , ...
  'TickLength'  , [.02 .02] , ...
  'XMinorTick'  , 'on'      , ...
  'YMinorTick'  , 'on'      , ...
  'YGrid'       , 'on'      , ...
  'GridLineStyle', '--'     , ...
  'GridAlpha'   , 0.2       , ...
  'XColor'      , [.3 .3 .3], ...
  'YColor'      , [.3 .3 .3], ...
  'LineWidth'   , 1         );
set(gcf, 'PaperPositionMode', 'auto');
print -opengl -dsvg 8kV_wvswithout_15umBOPP.svg 